<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alphabet Adventure Island</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
        @keyframes bounce-in { 0% { transform: scale(0); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }
        .floating { animation: float 3s ease-in-out infinite; }
        .game-card { transition: all 0.3s; cursor: pointer; }
        .game-card:hover { transform: translateY(-10px) scale(1.05); box-shadow: 0 20px 40px rgba(0,0,0,0.2); }
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); overflow-y: auto; }
        .modal.active { display: flex; align-items: center; justify-content: center; }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 min-h-screen">
    <header class="bg-gradient-to-r from-purple-600 via-pink-500 to-blue-500 text-white py-6 shadow-2xl sticky top-0 z-50">
        <div class="container mx-auto px-4 flex justify-between items-center">
            <div class="flex items-center gap-3">
                <span class="text-5xl floating">ğŸï¸</span>
                <div>
                    <h1 class="text-3xl font-bold">Alphabet Adventure Island</h1>
                    <p class="text-sm opacity-90">40+ Atividades de Aprendizagem</p>
                </div>
            </div>
            <div class="flex gap-3">
                <button id="soundToggle" class="bg-white/20 backdrop-blur p-3 rounded-full hover:bg-white/30 transition-all">
                    <span class="text-2xl">ğŸ”Š</span>
                </button>
                <div class="bg-yellow-400 px-6 py-3 rounded-full font-bold text-yellow-900 flex items-center gap-2">
                    <span class="text-2xl">â­</span>
                    <span id="totalScore">0</span>
                </div>
            </div>
        </div>
    </header>

    <main class="container mx-auto px-4 py-8">
        <div class="bg-white rounded-2xl shadow-xl p-2 mb-8 overflow-x-auto">
            <div class="flex gap-2 min-w-max">
                <button onclick="showCategory('alfabeto')" class="cat-btn px-6 py-3 rounded-xl font-bold transition-all bg-purple-500 text-white">ğŸ“š Alfabeto</button>
                <button onclick="showCategory('silabas')" class="cat-btn px-6 py-3 rounded-xl font-bold transition-all hover:bg-purple-100">ğŸ§© SÃ­labas</button>
                <button onclick="showCategory('palavras')" class="cat-btn px-6 py-3 rounded-xl font-bold transition-all hover:bg-purple-100">ğŸ“– Palavras</button>
                <button onclick="showCategory('numeros')" class="cat-btn px-6 py-3 rounded-xl font-bold transition-all hover:bg-purple-100">ğŸ”¢ NÃºmeros</button>
                <button onclick="showCategory('jogos')" class="cat-btn px-6 py-3 rounded-xl font-bold transition-all hover:bg-purple-100">ğŸ® Jogos</button>
                <button onclick="showCategory('arte')" class="cat-btn px-6 py-3 rounded-xl font-bold transition-all hover:bg-purple-100">ğŸ¨ Arte</button>
            </div>
        </div>
        <div id="gamesContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"></div>
    </main>

    <div id="gameModal" class="modal">
        <div class="bg-white rounded-3xl shadow-2xl max-w-6xl w-full mx-4 max-h-[90vh] overflow-y-auto">
            <div class="bg-gradient-to-r from-purple-500 to-pink-500 p-6 flex justify-between items-center sticky top-0 z-10">
                <h2 id="modalTitle" class="text-3xl font-bold text-white">Jogo</h2>
                <button onclick="closeModal()" class="bg-white/20 backdrop-blur p-3 rounded-full hover:bg-white/30 transition-all">
                    <span class="text-2xl text-white">âœ•</span>
                </button>
            </div>
            <div id="modalContent" class="p-8"></div>
        </div>
    </div>

    <script>
        const state = { score: 0, soundEnabled: true, currentCategory: 'alfabeto', canvas: null, ctx: null, isDrawing: false, currentColor: '#FF6B9D', brushSize: 10 };
        const games = {
            alfabeto: [
                { id: 'letter-explorer', title: 'Explorador de Letras', icon: 'ğŸ“š', desc: 'Aprenda o alfabeto', difficulty: 1 },
                { id: 'letter-sounds', title: 'Sons das Letras', icon: 'ğŸ”Š', desc: 'OuÃ§a sons', difficulty: 1 },
                { id: 'letter-tracing', title: 'TraÃ§ar Letras', icon: 'âœï¸', desc: 'Pratique escrita', difficulty: 2 },
                { id: 'letter-matching', title: 'Combinar Letras', icon: 'ğŸ”¤', desc: 'MaiÃºsculas/minÃºsculas', difficulty: 2 },
                { id: 'alphabet-song', title: 'MÃºsica ABC', icon: 'ğŸµ', desc: 'Cante o ABC', difficulty: 1 },
                { id: 'find-letter', title: 'Encontre a Letra', icon: 'ğŸ”', desc: 'Busca visual', difficulty: 2 },
                { id: 'letter-order', title: 'Ordem AlfabÃ©tica', icon: 'ğŸ¯', desc: 'SequÃªncia', difficulty: 3 },
                { id: 'vowel-game', title: 'Jogo das Vogais', icon: 'ğŸ…°ï¸', desc: 'A, E, I, O, U', difficulty: 1 }
            ],
            silabas: [
                { id: 'syllable-builder', title: 'Construtor de SÃ­labas', icon: 'ğŸ§©', desc: 'Forme sÃ­labas', difficulty: 2 },
                { id: 'syllable-matching', title: 'Combinar SÃ­labas', icon: 'ğŸ´', desc: 'Pares', difficulty: 2 },
                { id: 'syllable-sounds', title: 'Sons de SÃ­labas', icon: 'ğŸ”Š', desc: 'OuÃ§a', difficulty: 2 },
                { id: 'syllable-puzzle', title: 'Quebra-CabeÃ§a', icon: 'ğŸ§©', desc: 'Monte palavras', difficulty: 3 },
                { id: 'syllable-family', title: 'FamÃ­lia SilÃ¡bica', icon: 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§', desc: 'BA BE BI', difficulty: 2 },
                { id: 'syllable-race', title: 'Corrida', icon: 'ğŸƒ', desc: 'RÃ¡pido', difficulty: 3 },
                { id: 'syllable-bingo', title: 'Bingo', icon: 'ğŸ°', desc: 'Jogue bingo', difficulty: 2 },
                { id: 'syllable-hunt', title: 'CaÃ§a SÃ­labas', icon: 'ğŸ¯', desc: 'Encontre', difficulty: 2 }
            ],
            palavras: [
                { id: 'word-builder', title: 'Construtor', icon: 'ğŸ“', desc: 'Monte palavras', difficulty: 3 },
                { id: 'word-images', title: 'Palavra e Imagem', icon: 'ğŸ–¼ï¸', desc: 'Associe', difficulty: 2 },
                { id: 'word-scramble', title: 'Embaralhar', icon: 'ğŸ”€', desc: 'Desembaralhe', difficulty: 3 },
                { id: 'word-categories', title: 'Categorias', icon: 'ğŸ—‚ï¸', desc: 'Classifique', difficulty: 3 },
                { id: 'rhyme-time', title: 'Rimas', icon: 'ğŸ­', desc: 'Encontre rimas', difficulty: 3 },
                { id: 'word-search', title: 'CaÃ§a-Palavras', icon: 'ğŸ”', desc: 'Grade de busca', difficulty: 3 },
                { id: 'word-spelling', title: 'Soletrar', icon: 'ğŸ¤', desc: 'Ortografia', difficulty: 3 },
                { id: 'word-opposites', title: 'Opostos', icon: 'â†”ï¸', desc: 'AntÃ´nimos', difficulty: 4 }
            ],
            numeros: [
                { id: 'number-explorer', title: 'Explorador', icon: 'ğŸ”¢', desc: '0 a 100', difficulty: 1 },
                { id: 'counting-game', title: 'Contar', icon: 'ğŸ§®', desc: 'Conte objetos', difficulty: 1 },
                { id: 'number-tracing', title: 'TraÃ§ar', icon: 'âœï¸', desc: 'Escreva nÃºmeros', difficulty: 2 },
                { id: 'number-matching', title: 'Combinar', icon: 'ğŸ¯', desc: 'NÃºmero + quantidade', difficulty: 2 },
                { id: 'math-basics', title: 'MatemÃ¡tica', icon: 'â•', desc: '+  e  -', difficulty: 3 },
                { id: 'number-order', title: 'Ordem', icon: 'ğŸ“Š', desc: 'SequÃªncia', difficulty: 2 },
                { id: 'skip-counting', title: 'Pular', icon: 'ğŸ¦˜', desc: '2, 5, 10', difficulty: 3 },
                { id: 'number-patterns', title: 'PadrÃµes', icon: 'ğŸ”¢', desc: 'Complete', difficulty: 3 }
            ],
            jogos: [
                { id: 'memory-game', title: 'MemÃ³ria', icon: 'ğŸ§ ', desc: 'Encontre pares', difficulty: 2 },
                { id: 'simon-says', title: 'SimÃ£o Diz', icon: 'ğŸ‘‚', desc: 'Siga instruÃ§Ãµes', difficulty: 2 },
                { id: 'treasure-hunt', title: 'Tesouro', icon: 'ğŸ’', desc: 'Encontre', difficulty: 2 },
                { id: 'quiz-master', title: 'Quiz', icon: 'â“', desc: 'Perguntas', difficulty: 3 },
                { id: 'speed-challenge', title: 'Velocidade', icon: 'âš¡', desc: 'RÃ¡pido', difficulty: 3 },
                { id: 'puzzle-master', title: 'Puzzle', icon: 'ğŸ§©', desc: 'Quebra-cabeÃ§a', difficulty: 3 },
                { id: 'color-match', title: 'Cores', icon: 'ğŸ¨', desc: 'Combine', difficulty: 1 },
                { id: 'shape-sorter', title: 'Formas', icon: 'â¬›', desc: 'Classifique', difficulty: 2 }
            ],
            arte: [
                { id: 'free-draw', title: 'Desenho Livre', icon: 'ğŸ¨', desc: 'Desenhe', difficulty: 1 },
                { id: 'color-by-number', title: 'Colorir', icon: 'ğŸ–ï¸', desc: 'Por nÃºmeros', difficulty: 2 },
                { id: 'pattern-maker', title: 'PadrÃµes', icon: 'ğŸ”²', desc: 'Crie padrÃµes', difficulty: 2 },
                { id: 'stamp-art', title: 'Carimbos', icon: 'ğŸ–¼ï¸', desc: 'Use carimbos', difficulty: 1 },
                { id: 'coloring-book', title: 'Colorir', icon: 'ğŸ“š', desc: 'Livro', difficulty: 1 },
                { id: 'sticker-scene', title: 'Adesivos', icon: 'âœ¨', desc: 'Crie cenas', difficulty: 1 },
                { id: 'paint-splatter', title: 'Respingos', icon: 'ğŸ’¦', desc: 'Arte abstrata', difficulty: 1 },
                { id: 'doodle-master', title: 'Rabisco', icon: 'âœï¸', desc: 'Criativo', difficulty: 1 }
            ]
        };

        let currentLetter = 'A', selectedC = null, selectedV = null, memFlipped = [], memAttempts = 0, memPairs = 0, wordProg = [];

        function init() { loadGames('alfabeto'); updateScore(0); }

        function showCategory(cat) {
            state.currentCategory = cat;
            document.querySelectorAll('.cat-btn').forEach(b => {
                b.className = 'cat-btn px-6 py-3 rounded-xl font-bold transition-all hover:bg-purple-100';
            });
            event.target.className = 'cat-btn px-6 py-3 rounded-xl font-bold transition-all bg-purple-500 text-white';
            loadGames(cat);
        }

        function loadGames(cat) {
            const cont = document.getElementById('gamesContainer');
            cont.innerHTML = games[cat].map(g => `
                <div class="game-card bg-white rounded-2xl shadow-lg p-6" onclick="openGame('${g.id}', '${cat}')">
                    <div class="text-6xl text-center mb-4">${g.icon}</div>
                    <h3 class="text-xl font-bold text-purple-800 mb-2 text-center">${g.title}</h3>
                    <p class="text-gray-600 text-sm text-center mb-4">${g.desc}</p>
                    <div class="flex justify-center gap-1">${Array(g.difficulty).fill('â­').join('')}</div>
                    <button class="mt-4 w-full bg-gradient-to-r from-purple-500 to-pink-500 text-white font-bold py-3 rounded-xl">Jogar</button>
                </div>
            `).join('');
        }

        function openGame(id, cat) {
            const g = games[cat].find(x => x.id === id);
            document.getElementById('modalTitle').textContent = g.icon + ' ' + g.title;
            document.getElementById('modalContent').innerHTML = getContent(id);
            document.getElementById('gameModal').classList.add('active');
            setTimeout(() => initGame(id), 100);
        }

        function closeModal() {
            document.getElementById('gameModal').classList.remove('active');
            if (state.ctx) state.ctx.clearRect(0, 0, state.canvas.width, state.canvas.height);
        }

        function getContent(id) {
            const map = {
                'letter-explorer': `<div class="text-center mb-8"><div id="bigLetter" class="inline-block bg-gradient-to-br from-blue-400 to-purple-500 text-white text-9xl font-bold rounded-3xl p-12 shadow-2xl">A</div><button onclick="speak(currentLetter)" class="block mx-auto mt-6 bg-green-500 hover:bg-green-600 text-white font-bold py-4 px-8 rounded-full text-xl">ğŸ”Š Falar</button></div><div class="grid grid-cols-6 sm:grid-cols-9 gap-3">${'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split('').map((l,i) => {const c=['blue','green','yellow','red','purple','pink','indigo','orange','teal'][i%9]; return `<div class="bg-${c}-100 text-${c}-800 text-3xl font-bold rounded-xl p-4 text-center cursor-pointer hover:bg-${c}-200" onclick="selectLetter('${l}')">${l}</div>`}).join('')}</div>`,
                
                'syllable-builder': `<div class="text-center mb-8"><div id="sylDisp" class="inline-block bg-gradient-to-br from-purple-400 to-pink-500 text-white text-8xl font-bold rounded-3xl p-12 shadow-2xl min-w-[200px]">--</div><button onclick="speak(selectedC&&selectedV?selectedC+selectedV:'')" class="block mx-auto mt-6 bg-purple-500 hover:bg-purple-600 text-white font-bold py-3 px-6 rounded-full">ğŸ”Š Falar</button></div><div class="grid grid-cols-2 gap-8 max-w-2xl mx-auto"><div><h3 class="text-center font-bold text-2xl text-purple-700 mb-4">Consoantes</h3><div class="grid grid-cols-3 gap-3">${['B','C','D','F','G','H','J','L','M','N','P','R','S','T','V'].map(c=>`<div class="bg-purple-100 text-purple-800 text-3xl font-bold rounded-xl p-4 text-center cursor-pointer hover:bg-purple-200" onclick="selectedC='${c}';updateSyl()">${c}</div>`).join('')}</div></div><div><h3 class="text-center font-bold text-2xl text-pink-700 mb-4">Vogais</h3><div class="grid grid-cols-3 gap-3">${['A','E','I','O','U'].map(v=>`<div class="bg-pink-100 text-pink-800 text-3xl font-bold rounded-xl p-4 text-center cursor-pointer hover:bg-pink-200" onclick="selectedV='${v}';updateSyl()">${v}</div>`).join('')}</div></div></div>`,
                
                'memory-game': `<div class="text-center mb-6"><p class="text-2xl font-bold text-purple-700">Tentativas: <span id="memAtt">0</span></p><p class="text-xl text-green-600 mt-2">Pares: <span id="memPair">0</span>/6</p></div><div class="grid grid-cols-3 sm:grid-cols-4 gap-4 max-w-3xl mx-auto">${[{e:'ğŸ',w:'MAÃ‡Ãƒ'},{e:'ğŸˆ',w:'BALÃƒO'},{e:'ğŸ±',w:'GATO'},{e:'ğŸŒ¸',w:'FLOR'},{e:'âš½',w:'BOLA'},{e:'ğŸŒ',w:'SOL'}].flatMap((p,i)=>[{c:p.e,m:i},{c:p.w,m:i}]).sort(()=>Math.random()-.5).map((c,i)=>`<div class="mem-card h-32 cursor-pointer" onclick="flipMem(${i},${c.m})" data-f="0" data-m="0"><div class="w-full h-full relative" style="transform-style:preserve-3d;transition:transform 0.6s"><div class="absolute w-full h-full bg-gradient-to-br from-blue-400 to-purple-500 rounded-xl flex items-center justify-center text-4xl shadow-lg">â“</div><div class="absolute w-full h-full bg-white rounded-xl flex items-center justify-center text-3xl font-bold shadow-lg border-4 border-purple-300" style="transform:rotateY(180deg);backface-visibility:hidden">${c.c}</div></div></div>`).join('')}</div>`,
                
                'word-images': `<div class="grid grid-cols-2 md:grid-cols-3 gap-6">${[{w:'GATO',e:'ğŸ±',s:['GA','TO']},{w:'CASA',e:'ğŸ ',s:['CA','SA']},{w:'BOLA',e:'âš½',s:['BO','LA']},{w:'FLOR',e:'ğŸŒ¸',s:['FLOR']},{w:'SOL',e:'ğŸŒ',s:['SOL']},{w:'LUA',e:'ğŸŒ™',s:['LU','A']}].map(i=>`<div class="bg-gradient-to-br from-purple-100 to-pink-100 rounded-2xl p-6 text-center shadow-lg" onclick="speak('${i.w}')"><div class="text-7xl mb-4">${i.e}</div><h3 class="text-3xl font-bold text-purple-800 mb-2">${i.w}</h3><div class="flex justify-center gap-2 flex-wrap">${i.s.map(s=>`<span class="bg-white px-3 py-1 rounded-lg text-lg font-bold text-purple-600">${s}</span>`).join('')}</div><button class="mt-4 bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-full">ğŸ”Š Ouvir</button></div>`).join('')}</div>`,
                
                'number-explorer': `<div class="text-center mb-8"><div id="bigNum" class="inline-block bg-gradient-to-br from-green-400 to-blue-500 text-white text-9xl font-bold rounded-3xl p-12 shadow-2xl">1</div><button onclick="speak(document.getElementById('bigNum').textContent)" class="block mx-auto mt-6 bg-green-500 hover:bg-green-600 text-white font-bold py-4 px-8 rounded-full text-xl">ğŸ”Š Falar</button></div><div class="grid grid-cols-5 sm:grid-cols-10 gap-3">${Array.from({length:20},(_,i)=>i+1).map((n,i)=>{const c=['green','blue','yellow','red','purple','pink','indigo','orange','teal','cyan'][i%10];return `<div class="bg-${c}-100 text-${c}-800 text-3xl font-bold rounded-xl p-4 text-center cursor-pointer hover:bg-${c}-200" onclick="document.getElementById('bigNum').textContent=${n};speak('${n}');updateScore(5)">${n}</div>`}).join('')}</div>`,
                
                'free-draw': `<div class="flex gap-6"><div class="flex-shrink-0"><div class="bg-purple-50 rounded-2xl p-4 mb-4"><h3 class="font-bold text-purple-700 mb-3">ğŸ¨ Cores</h3><div class="grid grid-cols-3 gap-2">${['#FF6B9D','#FFA07A','#FFD700','#98FB98','#87CEEB','#DDA0DD','#F0E68C','#FFB6C1','#B0E0E6','#FFDAB9','#E6E6FA','#FFC0CB'].map(c=>`<div class="w-12 h-12 rounded-full cursor-pointer border-4 border-white shadow-lg hover:border-purple-300" style="background:${c}" onclick="state.currentColor='${c}'"></div>`).join('')}</div></div><div class="bg-purple-50 rounded-2xl p-4 mb-4"><h3 class="font-bold text-purple-700 mb-3">ğŸ–Œï¸ Tamanho</h3><input type="range" id="brSize" min="5" max="50" value="10" class="w-full" onchange="state.brushSize=this.value;document.getElementById('brDisp').textContent=this.value"><div class="text-center mt-2 font-bold text-purple-600"><span id="brDisp">10</span>px</div></div><button onclick="if(confirm('Limpar?'))state.ctx.clearRect(0,0,state.canvas.width,state.canvas.height)" class="w-full bg-red-400 hover:bg-red-500 text-white font-bold py-3 px-4 rounded-xl mb-2">ğŸ—‘ï¸ Limpar</button><button onclick="const l=document.createElement('a');l.download='desenho.png';l.href=state.canvas.toDataURL();l.click();speak('Salvo!');updateScore(20)" class="w-full bg-green-400 hover:bg-green-500 text-white font-bold py-3 px-4 rounded-xl">ğŸ’¾ Salvar</button></div><div class="flex-grow"><canvas id="drawCanvas" width="800" height="600" class="border-4 border-purple-300 rounded-2xl bg-white shadow-xl cursor-crosshair"></canvas></div></div>`,
                
                'counting-game': (() => { const items = ['ğŸ','ğŸˆ','â­','ğŸŒ¸','ğŸ±','ğŸ¨','âš½','ğŸŒ'], count = Math.floor(Math.random()*8)+3, item = items[Math.floor(Math.random()*items.length)]; return `<div class="text-center"><h3 class="text-3xl font-bold text-purple-700 mb-6">Quantos vocÃª vÃª?</h3><div class="bg-gradient-to-br from-blue-100 to-purple-100 rounded-2xl p-8 mb-6 inline-block"><div class="flex flex-wrap gap-4 justify-center max-w-2xl">${Array(count).fill(item).map(()=>`<span class="text-6xl">${item}</span>`).join('')}</div></div><div class="grid grid-cols-5 gap-4 max-w-xl mx-auto">${Array.from({length:10},(_,i)=>i+1).map(n=>`<button onclick="checkCount(${n},${count})" class="bg-green-100 hover:bg-green-200 text-green-800 font-bold text-3xl py-6 rounded-xl">${n}</button>`).join('')}</div><div id="cntRes" class="mt-6 text-2xl font-bold"></div></div>`})(),
                
                'word-builder': (() => { const words = ['GATO','BOLA','CASA','PATO','MALA'], word = words[Math.floor(Math.random()*words.length)], letters = word.split('').sort(()=>Math.random()-.5); return `<div class="text-center"><h3 class="text-2xl font-bold text-purple-700 mb-4">Monte a palavra!</h3><div class="text-6xl mb-8">${{GATO:'ğŸ±',BOLA:'âš½',CASA:'ğŸ ',PATO:'ğŸ¦†',MALA:'ğŸ§³'}[word]}</div><div id="wbDisp" class="flex justify-center gap-2 mb-8">${word.split('').map(()=>`<div class="w-16 h-20 bg-purple-100 border-4 border-purple-300 rounded-xl flex items-center justify-center text-3xl font-bold">_</div>`).join('')}</div><div class="flex justify-center gap-3 flex-wrap">${letters.map(l=>`<button onclick="addLetter('${l}','${word}')" class="bg-blue-400 hover:bg-blue-500 text-white font-bold text-3xl w-16 h-16 rounded-xl">${l}</button>`).join('')}</div><button onclick="wordProg=[];document.querySelectorAll('#wbDisp div').forEach(d=>d.textContent='_');document.getElementById('wbRes').textContent=''" class="mt-6 bg-red-400 hover:bg-red-500 text-white font-bold py-3 px-8 rounded-full">ğŸ”„ RecomeÃ§ar</button><div id="wbRes" class="mt-4 text-2xl font-bold"></div></div>`})(),
                
                'color-match': `<div class="text-center"><h3 class="text-2xl font-bold text-purple-700 mb-6">Combine as cores!</h3><div class="grid grid-cols-2 md:grid-cols-3 gap-6 max-w-4xl mx-auto">${[{n:'VERMELHO',h:'#FF0000',e:'ğŸ”´'},{n:'AZUL',h:'#0000FF',e:'ğŸ”µ'},{n:'VERDE',h:'#00FF00',e:'ğŸŸ¢'},{n:'AMARELO',h:'#FFFF00',e:'ğŸŸ¡'},{n:'ROXO',h:'#800080',e:'ğŸŸ£'},{n:'ROSA',h:'#FFC0CB',e:'ğŸŒ¸'}].map(c=>`<div class="bg-gradient-to-br from-purple-50 to-pink-50 rounded-2xl p-6 shadow-lg"><div class="text-6xl mb-4">${c.e}</div><div class="w-full h-24 rounded-xl mb-4 shadow-inner" style="background:${c.h}"></div><h4 class="text-2xl font-bold text-purple-800">${c.n}</h4><button onclick="speak('${c.n}')" class="mt-4 bg-purple-400 hover:bg-purple-500 text-white font-bold py-2 px-4 rounded-full">ğŸ”Š Ouvir</button></div>`).join('')}</div></div>`
            };
            return map[id] || `<div class="text-center py-16"><div class="text-8xl mb-6">ğŸ®</div><h3 class="text-3xl font-bold text-purple-700 mb-4">Em Desenvolvimento!</h3><p class="text-xl text-gray-600 mb-6">Este jogo serÃ¡ adicionado em breve.</p><button onclick="closeModal()" class="bg-purple-500 hover:bg-purple-600 text-white font-bold py-3 px-8 rounded-full">Voltar</button></div>`;
        }

        function initGame(id) {
            if (id === 'free-draw') initCanvas();
            else if (id === 'memory-game') { memFlipped = []; memAttempts = 0; memPairs = 0; }
            else if (id === 'word-builder') wordProg = [];
        }

        function selectLetter(l) {
            currentLetter = l;
            document.getElementById('bigLetter').textContent = l;
            speak(l);
            updateScore(5);
        }

        function updateSyl() {
            const d = document.getElementById('sylDisp');
            if (selectedC && selectedV) {
                d.textContent = selectedC + selectedV;
                speak(selectedC + selectedV);
                updateScore(10);
            } else if (selectedC) {
                d.textContent = selectedC + '-';
            } else if (selectedV) {
                d.textContent = '-' + selectedV;
            }
        }

        function flipMem(idx, match) {
            const cards = document.querySelectorAll('.mem-card');
            const card = cards[idx];
            if (card.dataset.f === '1' || card.dataset.m === '1' || memFlipped.length >= 2) return;
            
            card.dataset.f = '1';
            card.querySelector('div').style.transform = 'rotateY(180deg)';
            memFlipped.push({ idx, match });
            
            if (memFlipped.length === 2) {
                memAttempts++;
                document.getElementById('memAtt').textContent = memAttempts;
                
                setTimeout(() => {
                    if (memFlipped[0].match === memFlipped[1].match) {
                        cards[memFlipped[0].idx].dataset.m = '1';
                        cards[memFlipped[1].idx].dataset.m = '1';
                        memPairs++;
                        document.getElementById('memPair').textContent = memPairs;
                        updateScore(20);
                        speak('ParabÃ©ns!');
                        if (memPairs === 6) {
                            setTimeout(() => {
                                speak('VocÃª completou o jogo!');
                                alert('ğŸ‰ VocÃª encontrou todos os pares!');
                                updateScore(50);
                            }, 500);
                        }
                    } else {
                        cards[memFlipped[0].idx].dataset.f = '0';
                        cards[memFlipped[1].idx].dataset.f = '0';
                        cards[memFlipped[0].idx].querySelector('div').style.transform = '';
                        cards[memFlipped[1].idx].querySelector('div').style.transform = '';
                    }
                    memFlipped = [];
                }, 1000);
            }
        }

        function checkCount(ans, correct) {
            const res = document.getElementById('cntRes');
            if (ans === correct) {
                res.textContent = 'ğŸ‰ Correto!';
                res.className = 'mt-6 text-2xl font-bold text-green-600';
                speak('Correto! Muito bem!');
                updateScore(15);
                setTimeout(() => {
                    closeModal();
                    openGame('counting-game', 'numeros');
                }, 2000);
            } else {
                res.textContent = 'âŒ Tente novamente!';
                res.className = 'mt-6 text-2xl font-bold text-red-600';
            }
        }

        function addLetter(l, target) {
            wordProg.push(l);
            const slots = document.querySelectorAll('#wbDisp div');
            if (wordProg.length <= target.length) {
                slots[wordProg.length - 1].textContent = l;
            }
            if (wordProg.length === target.length) {
                const built = wordProg.join('');
                const res = document.getElementById('wbRes');
                if (built === target) {
                    res.textContent = 'ğŸ‰ Perfeito!';
                    res.className = 'mt-4 text-2xl font-bold text-green-600';
                    speak('ParabÃ©ns!');
                    updateScore(25);
                } else {
                    res.textContent = 'âŒ Tente novamente!';
                    res.className = 'mt-4 text-2xl font-bold text-red-600';
                    setTimeout(() => {
                        wordProg = [];
                        slots.forEach(s => s.textContent = '_');
                        res.textContent = '';
                    }, 1500);
                }
            }
        }

        function initCanvas() {
            state.canvas = document.getElementById('drawCanvas');
            if (!state.canvas) return;
            state.ctx = state.canvas.getContext('2d');
            state.ctx.lineCap = 'round';
            state.ctx.lineJoin = 'round';
            
            const startDraw = (e) => {
                state.isDrawing = true;
                const pos = getPos(e);
                state.ctx.beginPath();
                state.ctx.moveTo(pos.x, pos.y);
            };
            
            const draw = (e) => {
                if (!state.isDrawing) return;
                const pos = getPos(e);
                state.ctx.strokeStyle = state.currentColor;
                state.ctx.lineWidth = state.brushSize;
                state.ctx.lineTo(pos.x, pos.y);
                state.ctx.stroke();
            };
            
            const stopDraw = () => { state.isDrawing = false; };
            
            const getPos = (e) => {
                const rect = state.canvas.getBoundingClientRect();
                const clientX = e.touches ? e.touches[0].clientX : e.clientX;
                const clientY = e.touches ? e.touches[0].clientY : e.clientY;
                return {
                    x: (clientX - rect.left) * (state.canvas.width / rect.width),
                    y: (clientY - rect.top) * (state.canvas.height / rect.height)
                };
            };
            
            state.canvas.addEventListener('mousedown', startDraw);
            state.canvas.addEventListener('mousemove', draw);
            state.canvas.addEventListener('mouseup', stopDraw);
            state.canvas.addEventListener('mouseout', stopDraw);
            state.canvas.addEventListener('touchstart', (e) => { e.preventDefault(); startDraw(e); });
            state.canvas.addEventListener('touchmove', (e) => { e.preventDefault(); draw(e); });
            state.canvas.addEventListener('touchend', (e) => { e.preventDefault(); stopDraw(); });
        }

        function speak(txt) {
            if (!state.soundEnabled || !txt) return;
            const u = new SpeechSynthesisUtterance(txt);
            u.lang = 'pt-BR';
            u.rate = 0.8;
            u.pitch = 1.2;
            speechSynthesis.cancel();
            speechSynthesis.speak(u);
        }

        function updateScore(pts) {
            state.score += pts;
            document.getElementById('totalScore').textContent = state.score;
            if (pts > 0) {
                const el = document.getElementById('totalScore').parentElement;
                el.style.animation = 'bounce-in 0.5s';
                setTimeout(() => { el.style.animation = ''; }, 500);
            }
        }

        document.getElementById('soundToggle').onclick = () => {
            state.soundEnabled = !state.soundEnabled;
            document.getElementById('soundToggle').querySelector('span').textContent = state.soundEnabled ? 'ğŸ”Š' : 'ğŸ”‡';
        };

        document.addEventListener('keydown', (e) => { if (e.key === 'Escape') closeModal(); });

        window.addEventListener('DOMContentLoaded', () => {
            init();
            setTimeout(() => speak('Bem-vindo ao Alphabet Adventure Island! Escolha uma atividade!'), 1000);
        });
    </script>
</body>
</html>