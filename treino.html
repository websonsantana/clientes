<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plano de Treino de Corrida Personalizado</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        
        .glow {
            box-shadow: 0 0 10px rgba(59, 130, 246, 0.5);
        }
        
        .heartbeat {
            animation: heartbeat 1.5s ease-in-out infinite both;
        }

        @keyframes heartbeat {
            0% { transform: scale(1); }
            25% { transform: scale(1.1); }
            50% { transform: scale(1); }
            75% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        /* Custom transition for modal */
        .modal-enter {
            opacity: 0;
            transform: scale(0.95);
        }
        
        .modal-enter-active {
            opacity: 1;
            transform: scale(1);
            transition: opacity 200ms, transform 200ms;
        }
        
        .modal-exit {
            opacity: 1;
            transform: scale(1);
        }
        
        .modal-exit-active {
            opacity: 0;
            transform: scale(0.95);
            transition: opacity 200ms, transform 200ms;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <!-- Config Modal -->
        <div id="config-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
            <div class="bg-white rounded-lg shadow-xl overflow-hidden w-full max-w-md mx-4">
                <div class="bg-blue-500 p-4 text-white text-center">
                    <i class="fas fa-cog text-3xl mb-2"></i>
                    <h3 class="text-xl font-bold">Configurar Plano de Treino</h3>
                </div>
                <div class="p-6">
                    <div class="mb-4">
                        <label class="block text-gray-700 font-medium mb-2">N√≠vel do Atleta</label>
                        <div class="grid grid-cols-3 gap-2">
                            <button data-level="beginner" class="level-btn bg-blue-100 text-blue-800 py-2 px-4 rounded border border-blue-200 font-medium hover:bg-blue-200">
                                <i class="fas fa-baby mr-1"></i> Iniciante
                            </button>
                            <button data-level="intermediate" class="level-btn bg-green-100 text-green-800 py-2 px-4 rounded border border-green-200 font-medium hover:bg-green-200">
                                <i class="fas fa-running mr-1"></i> Intermedi√°rio
                            </button>
                            <button data-level="advanced" class="level-btn bg-red-100 text-red-800 py-2 px-4 rounded border border-red-200 font-medium hover:bg-red-200">
                                <i class="fas fa-fire mr-1"></i> Avan√ßado
                            </button>
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <label class="block text-gray-700 font-medium mb-2">Meta de Dist√¢ncia</label>
                        <div class="grid grid-cols-3 gap-2">
                            <button data-distance="5" class="distance-btn bg-purple-100 text-purple-800 py-2 px-4 rounded border border-purple-200 font-medium hover:bg-purple-200">
                                5 KM
                            </button>
                            <button data-distance="10" class="distance-btn bg-purple-100 text-purple-800 py-2 px-4 rounded border border-purple-200 font-medium hover:bg-purple-200">
                                10 KM
                            </button>
                            <button data-distance="21" class="distance-btn bg-purple-100 text-purple-800 py-2 px-4 rounded border border-purple-200 font-medium hover:bg-purple-200">
                                21 KM
                            </button>
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <label class="block text-gray-700 font-medium mb-2">Dura√ß√£o do Plano</label>
                        <select id="duration-select" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                            <option value="8">8 semanas</option>
                            <option value="12">12 semanas</option>
                            <option value="16">16 semanas</option>
                        </select>
                    </div>
                    
                    <div class="flex justify-between mt-6">
                        <button id="cancel-config" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded">
                            Cancelar
                        </button>
                        <button id="save-config" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
                            Salvar Configura√ß√µes
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Header -->
        <header class="bg-gradient-to-r from-blue-600 to-indigo-700 rounded-lg shadow-md p-6 mb-8 text-white">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="mb-4 md:mb-0">
                    <h1 class="text-3xl md:text-4xl font-bold">üèÉ‚Äç‚ôÇÔ∏è Plano de Treino de Corrida</h1>
                    <p class="text-blue-100 mt-2" id="plan-description">Prepare-se para correr <span id="goal-distance">5km</span> em <span id="goal-weeks">8</span> semanas!</p>
                </div>
                <div class="flex items-center space-x-2">
                    <button id="config-btn" class="bg-white text-blue-600 px-4 py-2 rounded-full font-semibold hover:bg-blue-50">
                        <i class="fas fa-cog mr-1"></i> Configurar
                    </button>
                    <div class="bg-white text-blue-600 px-4 py-2 rounded-full font-semibold">
                        <span id="current-week-text">Semana 1</span> de <span id="total-weeks">8</span>
                    </div>
                    <div class="hidden md:block">
                        <span class="bg-white text-blue-600 px-4 py-2 rounded-full font-semibold">
                            <span id="days-completed">0</span> dias completados
                        </span>
                    </div>
                </div>
            </div>
                    
            <div class="mt-6 flex flex-wrap gap-2">
                <div class="bg-white bg-opacity-20 px-3 py-2 rounded-full flex items-center">
                    <i class="fas fa-signal mr-2"></i> CA: Caminhada (50-65% FCM)
                </div>
                <div class="bg-white bg-opacity-20 px-3 py-2 rounded-full flex items-center">
                    <i class="fas fa-running mr-2"></i> LE: Corrida Leve (65-75% FCM)
                </div>
                <div class="bg-white bg-opacity-20 px-3 py-2 rounded-full flex items-center">
                    <i class="fas fa-fire mr-2"></i> MO: Corrida Moderada (75-85% FCM)
                </div>
                <div class="bg-white bg-opacity-20 px-3 py-2 rounded-full flex items-center">
                    <i class="fas fa-bolt mr-2"></i> FO: Corrida Forte (85-90% FCM)
                </div>
                <div class="bg-white bg-opacity-20 px-3 py-2 rounded-full flex items-center">
                    <i class="fas fa-heartbeat mr-2"></i> MF: Corrida Muito Forte (90-100% FCM)
                </div>
            </div>
        </header>
                
        <!-- Progress Summary -->
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
            <div class="bg-white rounded-lg shadow p-4">
                <div class="flex justify-between items-center">
                    <h3 class="text-gray-500">Progresso</h3>
                    <i class="fas fa-chart-line text-blue-500"></i>
                </div>
                <div class="mt-2">
                    <div class="w-full bg-gray-200 rounded-full h-2.5">
                        <div id="overall-progress" class="bg-blue-600 h-2.5 rounded-full" style="width: 12.5%"></div>
                    </div>
                    <div class="text-right mt-1 text-sm text-gray-600">
                        <span id="progress-percentage">12.5%</span> completo
                    </div>
                </div>
            </div>
                    
            <div class="bg-white rounded-lg shadow p-4">
                <div class="flex justify-between items-center">
                    <h3 class="text-gray-500">Semanas</h3>
                    <i class="fas fa-calendar-week text-green-500"></i>
                </div>
                <div class="mt-2 text-2xl font-bold">
                    <span id="completed-weeks">0</span>/<span id="total-completed-weeks">8</span>
                </div>
            </div>
                    
            <div class="bg-white rounded-lg shadow p-4">
                <div class="flex justify-between items-center">
                    <h3 class="text-gray-500">Treinos</h3>
                    <i class="fas fa-dumbbell text-yellow-500"></i>
                </div>
                <div class="mt-2 text-2xl font-bold">
                    <span id="completed-workouts">0</span>/<span id="total-workouts">24</span>
                </div>
            </div>
                    
            <div class="bg-white rounded-lg shadow p-4">
                <div class="flex justify-between items-center">
                    <h3 class="text-gray-500">Meta Final</h3>
                    <i class="fas fa-flag-checkered text-red-500"></i>
                </div>
                <div class="mt-2 text-xl font-bold whitespace-nowrap">
                    <span id="final-goal">5K</span> em <span id="final-weeks">8</span> semanas
                </div>
            </div>
        </div>
                
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Week Navigation -->
            <div class="lg:col-span-1">
                <div class="bg-white rounded-lg shadow-md overflow-hidden">
                    <div class="bg-gray-800 text-white p-4 font-bold">
                        Selecione a Semana
                    </div>
                    <div class="p-4 space-y-2" id="week-buttons-container">
                        <!-- Week buttons will be generated by JavaScript -->
                    </div>
                            
                    <div class="bg-gray-50 p-4 border-t">
                        <h3 class="font-bold text-gray-700 mb-2">Seu Progresso</h3>
                        <div class="flex items-center space-x-4">
                            <div class="relative w-full">
                                <div class="w-full bg-gray-200 rounded-full h-3">
                                    <div id="user-progress-bar" class="bg-gradient-to-r from-blue-400 to-purple-500 h-3 rounded-full" style="width: 0%"></div>
                                </div>
                                <div class="text-xs text-gray-500 mt-1 text-right">
                                    <span id="user-progress-text">0</span>%
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                        
                <!-- Legend -->
                <div class="bg-white rounded-lg shadow-md mt-6 p-4">
                    <h3 class="font-bold text-gray-700 mb-3">Legenda de Atividades</h3>
                    <div class="space-y-2">
                        <div class="flex items-center">
                            <div class="w-8 h-8 bg-green-200 rounded-full flex items-center justify-center mr-2">
                                <i class="fas fa-walking text-green-700"></i>
                            </div>
                            <span class="text-sm">CA: Caminhada (50-65% FCM)</span>
                        </div>
                        <div class="flex items-center">
                            <div class="w-8 h-8 bg-blue-200 rounded-full flex items-center justify-center mr-2">
                                <i class="fas fa-running text-blue-700"></i>
                            </div>
                            <span class="text-sm">LE: Corrida Leve (65-75% FCM)</span>
                        </div>
                        <div class="flex items-center">
                            <div class="w-8 h-8 bg-yellow-200 rounded-full flex items-center justify-center mr-2">
                                <i class="fas fa-fire text-yellow-700"></i>
                            </div>
                            <span class="text-sm">MO: Corrida Moderada (75-85% FCM)</span>
                        </div>
                        <div class="flex items-center">
                            <div class="w-8 h-8 bg-orange-200 rounded-full flex items-center justify-center mr-2">
                                <i class="fas fa-bolt text-orange-700"></i>
                            </div>
                            <span class="text-sm">FO: Corrida Forte (85-90% FCM)</span>
                        </div>
                        <div class="flex items-center">
                            <div class="w-8 h-8 bg-red-200 rounded-full flex items-center justify-center mr-2">
                                <i class="fas fa-heartbeat text-red-700"></i>
                            </div>
                            <span class="text-sm">MF: Corrida Muito Forte (90-100% FCM)</span>
                        </div>
                        <div class="flex items-center">
                            <div class="w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center mr-2">
                                <i class="fas fa-coffee text-gray-700"></i>
                            </div>
                            <span class="text-sm">DAY OFF: Dia de descanso</span>
                        </div>
                    </div>
                </div>
                
                <!-- Athlete Info -->
                <div class="bg-white rounded-lg shadow-md mt-6 p-4">
                    <h3 class="font-bold text-gray-700 mb-3">Informa√ß√µes do Atleta</h3>
                    <div class="space-y-3">
                        <div>
                            <span class="text-sm text-gray-500">N√≠vel:</span>
                            <div class="flex items-center mt-1">
                                <span id="athlete-level" class="font-medium">Iniciante</span>
                                <span id="level-badge" class="ml-2 bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full">Novato</span>
                            </div>
                        </div>
                        <div>
                            <span class="text-sm text-gray-500">Meta:</span>
                            <div class="mt-1 font-medium" id="athlete-goal">5 KM</div>
                        </div>
                        <div>
                            <span class="text-sm text-gray-500">Dura√ß√£o:</span>
                            <div class="mt-1 font-medium" id="athlete-duration">8 semanas</div>
                        </div>
                    </div>
                </div>
            </div>
                    
            <!-- Week Schedule -->
            <div class="lg:col-span-2">
                <div class="bg-white rounded-lg shadow-md overflow-hidden">
                    <div class="bg-blue-600 text-white p-4 font-bold flex justify-between items-center">
                        <div>
                            <span id="selected-week-title">Semana 1</span>
                            <span class="text-blue-200 ml-2 font-normal text-sm">(Segunda a Domingo)</span>
                        </div>
                        <div class="flex space-x-2">
                            <button id="prev-week" class="bg-white text-blue-600 p-1 rounded-full w-8 h-8 flex items-center justify-center hover:bg-blue-50">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            <button id="next-week" class="bg-white text-blue-600 p-1 rounded-full w-8 h-8 flex items-center justify-center hover:bg-blue-50">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                    </div>
                            
                    <div id="week-schedule" class="divide-y">
                        <!-- Week content will be inserted here by JavaScript -->
                    </div>
                            
                    <div class="bg-gray-50 p-4 border-t">
                        <button id="save-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg w-full flex items-center justify-center">
                            <i class="fas fa-save mr-2"></i> Salvar Progresso
                        </button>
                    </div>
                </div>
                        
                <!-- Current Week Stats -->
                <div class="bg-white rounded-lg shadow-md mt-6 p-6">
                    <h3 class="font-bold text-gray-700 mb-4 text-lg">Estat√≠sticas da Semana Atual</h3>
                    <div class="grid grid-cols-3 gap-4">
                        <div class="bg-blue-50 p-3 rounded-lg text-center">
                            <div class="text-3xl font-bold text-blue-600 mb-1">
                                <span id="current-week-completed">0</span>
                            </div>
                            <div class="text-xs text-blue-800">Treinos conclu√≠dos</div>
                        </div>
                        <div class="bg-green-50 p-3 rounded-lg text-center">
                            <div class="text-3xl font-bold text-green-600 mb-1">
                                <span id="current-week-rest">7</span>
                            </div>
                            <div class="text-xs text-green-800">Dias de descanso</div>
                        </div>
                        <div class="bg-orange-50 p-3 rounded-lg text-center">
                            <div class="text-3xl font-bold text-orange-600 mb-1">
                                <span id="current-week-duration">25</span>'
                            </div>
                            <div class="text-xs text-orange-800">Tempo total</div>
                        </div>
                    </div>
                </div>
                        
                <!-- Workout Explanation -->
                <div class="bg-white rounded-lg shadow-md mt-6 p-6">
                    <h3 class="font-bold text-gray-700 mb-4 text-lg">Instru√ß√µes do Treino</h3>
                    <div id="workout-explanation" class="prose prose-sm">
                        <div class="alert alert-info bg-blue-50 border-l-4 border-blue-500 p-3 mb-4">
                            <div class="flex items-center">
                                <div class="flex-shrink-0">
                                    <i class="fas fa-info-circle text-blue-500"></i>
                                </div>
                                <div class="ml-3">
                                    <h3 class="text-sm font-medium text-blue-800">Como interpretar os treinos</h3>
                                    <div class="mt-2 text-sm text-blue-700">
                                        <p>Exemplo: <strong>3'LE 3x 12'CA</strong> significa:</p>
                                        <ul class="list-disc pl-5 space-y-1">
                                            <li>3 minutos de corrida leve (LE)</li>
                                            <li>3 repeti√ß√µes de 12 minutos de caminhada (CA)</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                                
                        <div class="alert alert-warning bg-yellow-50 border-l-4 border-yellow-400 p-3">
                            <div class="flex items-center">
                                <div class="flex-shrink-0">
                                    <i class="fas fa-exclamation-triangle text-yellow-500"></i>
                                </div>
                                <div class="ml-3">
                                    <h3 class="text-sm font-medium text-yellow-800">Dicas para iniciantes</h3>
                                    <div class="mt-2 text-sm text-yellow-700">
                                        <ul class="list-disc pl-5 space-y-1">
                                            <li>Sempre fa√ßa um aquecimento de 5 minutos antes</li>
                                            <li>Beba √°gua regularmente</li>
                                            <li>Respeite seus limites e os dias de descanso</li>
                                            <li>Use t√™nis adequado para corrida</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Completion Modal -->
    <div id="completion-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-lg shadow-xl overflow-hidden w-full max-w-md mx-4">
            <div class="bg-green-500 p-4 text-white text-center">
                <i class="fas fa-check-circle text-4xl mb-2"></i>
                <h3 class="text-xl font-bold">Treino Completo!</h3>
            </div>
            <div class="p-6 text-center">
                <p class="text-gray-700 mb-4">Voc√™ completou com sucesso o treino de hoje. Parab√©ns!</p>
                <div class="bg-green-50 border border-green-200 rounded p-4 mb-4">
                    <div class="text-xl font-bold text-green-600">+5 pontos</div>
                    <div class="text-sm text-green-500">Seu progresso foi salvo</div>
                </div>
                <button id="close-modal" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-6 rounded-lg">
                    Continuar
                </button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Configuration
            let config = {
                level: 'beginner',
                distance: 5,
                duration: 8
            };
            
            // Training program templates
            const trainingTemplates = {
                beginner: {
                    5: {
                        8: generateBeginner5KPlan(8),
                        12: generateBeginner5KPlan(12),
                        16: generateBeginner5KPlan(16)
                    },
                    10: {
                        8: generateBeginner10KPlan(8),
                        12: generateBeginner10KPlan(12),
                        16: generateBeginner10KPlan(16)
                    },
                    21: {
                        8: generateBeginnerHalfMarathonPlan(8),
                        12: generateBeginnerHalfMarathonPlan(12),
                        16: generateBeginnerHalfMarathonPlan(16)
                    }
                },
                intermediate: {
                    5: {
                        8: generateIntermediate5KPlan(8),
                        12: generateIntermediate5KPlan(12),
                        16: generateIntermediate5KPlan(16)
                    },
                    10: {
                        8: generateIntermediate10KPlan(8),
                        12: generateIntermediate10KPlan(12),
                        16: generateIntermediate10KPlan(16)
                    },
                    21: {
                        8: generateIntermediateHalfMarathonPlan(8),
                        12: generateIntermediateHalfMarathonPlan(12),
                        16: generateIntermediateHalfMarathonPlan(16)
                    }
                },
                advanced: {
                    5: {
                        8: generateAdvanced5KPlan(8),
                        12: generateAdvanced5KPlan(12),
                        16: generateAdvanced5KPlan(16)
                    },
                    10: {
                        8: generateAdvanced10KPlan(8),
                        12: generateAdvanced10KPlan(12),
                        16: generateAdvanced10KPlan(16)
                    },
                    21: {
                        8: generateAdvancedHalfMarathonPlan(8),
                        12: generateAdvancedHalfMarathonPlan(12),
                        16: generateAdvancedHalfMarathonPlan(16)
                    }
                }
            };
            
            // Current training program
            let trainingProgram = {};
            
            // Current week
            let currentWeek = 1;
            
            // Load from localStorage if available
            if (localStorage.getItem('runningPlanConfig')) {
                const savedConfig = JSON.parse(localStorage.getItem('runningPlanConfig'));
                config.level = savedConfig.level || 'beginner';
                config.distance = savedConfig.distance || 5;
                config.duration = savedConfig.duration || 8;
                
                // Update UI to reflect saved config
                updateConfigUI();
                
                // Load the appropriate training program
                trainingProgram = trainingTemplates[config.level][config.distance][config.duration];
                
                if (localStorage.getItem('runningPlanData')) {
                    const savedData = JSON.parse(localStorage.getItem('runningPlanData'));
                    currentWeek = savedData.currentWeek || 1;
                    
                    // Update completed status from saved data
                    for (let week in savedData.weeks) {
                        if (trainingProgram[week]) {
                            trainingProgram[week].days.forEach((day, index) => {
                                if (savedData.weeks[week] && savedData.weeks[week][index] !== undefined) {
                                    day.completed = savedData.weeks[week][index];
                                }
                            });
                        }
                    }
                }
            } else {
                // Default to beginner 5K 8-week plan
                trainingProgram = trainingTemplates.beginner[5][8];
            }
            
            // Initialize UI
            renderWeekButtons();
            renderWeekSchedule(currentWeek);
            updateOverallProgress();
            updateConfigUI();
            
            // Event listeners
            document.getElementById('config-btn').addEventListener('click', function() {
                document.getElementById('config-modal').classList.remove('hidden');
                
                // Highlight current selections
                document.querySelectorAll('.level-btn').forEach(btn => {
                    btn.classList.remove('bg-blue-600', 'text-white');
                    if (btn.dataset.level === config.level) {
                        btn.classList.add('bg-blue-600', 'text-white');
                    }
                });
                
                document.querySelectorAll('.distance-btn').forEach(btn => {
                    btn.classList.remove('bg-purple-600', 'text-white');
                    if (parseInt(btn.dataset.distance) === config.distance) {
                        btn.classList.add('bg-purple-600', 'text-white');
                    }
                });
                
                document.getElementById('duration-select').value = config.duration;
            });
            
            document.getElementById('cancel-config').addEventListener('click', function() {
                document.getElementById('config-modal').classList.add('hidden');
            });
            
            document.getElementById('save-config').addEventListener('click', function() {
                // Save configuration
                localStorage.setItem('runningPlanConfig', JSON.stringify(config));
                
                // Reload the appropriate training program
                trainingProgram = trainingTemplates[config.level][config.distance][config.duration];
                
                // Reset current week to 1 when changing plans
                currentWeek = 1;
                
                // Update UI
                renderWeekButtons();
                renderWeekSchedule(currentWeek);
                updateOverallProgress();
                updateConfigUI();
                
                // Close modal
                document.getElementById('config-modal').classList.add('hidden');
            });
            
            document.querySelectorAll('.level-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    config.level = this.dataset.level;
                    
                    // Update UI
                    document.querySelectorAll('.level-btn').forEach(b => {
                        b.classList.remove('bg-blue-600', 'text-white');
                    });
                    this.classList.add('bg-blue-600', 'text-white');
                });
            });
            
            document.querySelectorAll('.distance-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    config.distance = parseInt(this.dataset.distance);
                    
                    // Update UI
                    document.querySelectorAll('.distance-btn').forEach(b => {
                        b.classList.remove('bg-purple-600', 'text-white');
                    });
                    this.classList.add('bg-purple-600', 'text-white');
                });
            });
            
            document.getElementById('duration-select').addEventListener('change', function() {
                config.duration = parseInt(this.value);
            });
            
            document.getElementById('prev-week').addEventListener('click', function() {
                if (currentWeek > 1) {
                    currentWeek--;
                    renderWeekSchedule(currentWeek);
                    updateOverallProgress();
                }
            });
            
            document.getElementById('next-week').addEventListener('click', function() {
                if (currentWeek < config.duration) {
                    currentWeek++;
                    renderWeekSchedule(currentWeek);
                    updateOverallProgress();
                }
            });
            
            document.addEventListener('click', function(e) {
                if (e.target.closest('.complete-day-btn')) {
                    const dayIndex = parseInt(e.target.closest('.complete-day-btn').dataset.dayIndex);
                    trainingProgram[currentWeek].days[dayIndex].completed = true;
                    
                    // Show completion modal
                    document.getElementById('completion-modal').classList.remove('hidden');
                    
                    // Re-render
                    renderWeekSchedule(currentWeek);
                    updateOverallProgress();
                }
                
                if (e.target.closest('.week-btn')) {
                    currentWeek = parseInt(e.target.closest('.week-btn').dataset.week);
                    renderWeekSchedule(currentWeek);
                    updateOverallProgress();
                }
            });
            
            document.getElementById('close-modal').addEventListener('click', function() {
                document.getElementById('completion-modal').classList.add('hidden');
            });
            
            document.getElementById('save-btn').addEventListener('click', function() {
                // Prepare data to save
                const saveData = {
                    currentWeek: currentWeek,
                    weeks: {}
                };
                
                for (let weekNum in trainingProgram) {
                    saveData.weeks[weekNum] = trainingProgram[weekNum].days.map(day => day.completed);
                }
                
                // Save to localStorage
                localStorage.setItem('runningPlanData', JSON.stringify(saveData));
                
                // Show visual feedback
                this.innerHTML = '<i class="fas fa-check-circle mr-2"></i> Progresso Salvo!';
                this.classList.remove('bg-blue-600', 'hover:bg-blue-700');
                this.classList.add('bg-green-500', 'hover:bg-green-600');
                
                setTimeout(() => {
                    this.innerHTML = '<i class="fas fa-save mr-2"></i> Salvar Progresso';
                    this.classList.remove('bg-green-500', 'hover:bg-green-600');
                    this.classList.add('bg-blue-600', 'hover:bg-blue-700');
                }, 2000);
            });
            
            // Render functions
            function renderWeekButtons() {
                const container = document.getElementById('week-buttons-container');
                container.innerHTML = '';
                
                for (let i = 1; i <= config.duration; i++) {
                    const week = trainingProgram[i];
                    const btn = document.createElement('button');
                    btn.className = 'week-btn bg-gray-200 hover:bg-blue-100 w-full p-3 rounded-md flex justify-between items-center';
                    btn.dataset.week = i;
                    
                    const weekText = document.createElement('span');
                    weekText.textContent = `Semana ${i}`;
                    
                    const badge = document.createElement('span');
                    badge.className = 'badge hidden';
                    
                    // Special badges for certain weeks
                    if (i === 1) {
                        badge.textContent = 'Introdu√ß√£o';
                        badge.className = 'badge bg-white text-blue-600 px-2 py-1 rounded-full text-xs font-bold';
                    } else if (i === Math.floor(config.duration / 2)) {
                        badge.textContent = '50%';
                        badge.className = 'badge bg-blue-100 text-blue-600 px-2 py-1 rounded-full text-xs font-bold';
                    } else if (i === config.duration - 1) {
                        badge.textContent = 'Intenso';
                        badge.className = 'badge bg-red-100 text-red-600 px-2 py-1 rounded-full text-xs font-bold';
                    } else if (i === config.duration) {
                        badge.textContent = `PROVA ${config.distance}K`;
                        badge.className = 'badge bg-purple-100 text-purple-600 px-2 py-1 rounded-full text-xs font-bold';
                    }
                    
                    // Check if week has any completed workouts
                    const completedCount = week.days.filter(day => day.completed).length;
                    if (completedCount > 0 && i !== currentWeek) {
                        btn.className = 'week-btn bg-green-100 text-green-800 border border-green-200 w-full p-3 rounded-md flex justify-between items-center';
                        
                        const completedBadge = document.createElement('span');
                        completedBadge.className = 'badge bg-green-200 text-green-700 px-2 py-1 rounded-full text-xs font-bold';
                        completedBadge.textContent = `${completedCount}/7`;
                        
                        btn.appendChild(weekText);
                        btn.appendChild(completedBadge);
                    } else {
                        btn.appendChild(weekText);
                        if (!badge.classList.contains('hidden')) {
                            btn.appendChild(badge);
                        }
                    }
                    
                    // Highlight current week
                    if (i === currentWeek) {
                        btn.className = 'week-btn bg-blue-600 text-white w-full p-3 rounded-md flex justify-between items-center';
                    }
                    
                    container.appendChild(btn);
                }
            }
            
            function renderWeekSchedule(weekNum) {
                const week = trainingProgram[weekNum];
                const weekScheduleEl = document.getElementById('week-schedule');
                
                // Update title
                document.getElementById('selected-week-title').textContent = week.title;
                document.getElementById('current-week-text').textContent = `Semana ${weekNum}`;
                
                // Clear previous content
                weekScheduleEl.innerHTML = '';
                
                // Create day elements
                week.days.forEach((day, index) => {
                    const dayEl = document.createElement('div');
                    dayEl.className = `p-4 border-b ${day.completed ? 'bg-green-50' : 'bg-white'}`;
                    
                    const workoutType = day.workout.includes('DAY OFF') ? 'Rest' : 
                                      day.workout.includes('PROVA') ? 'Race' : 'Workout';
                    
                    dayEl.innerHTML = `
                        <div class="flex items-start">
                            <div class="flex-shrink-0 mr-4 mt-1">
                                ${workoutType === 'Rest' ? 
                                 `<div class="w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center">
                                     <i class="fas fa-coffee text-gray-400"></i>
                                 </div>` :
                                workoutType === 'Race' ?
                                 `<div class="w-10 h-10 rounded-full bg-purple-100 flex items-center justify-center">
                                     <i class="fas fa-flag-checkered text-purple-500"></i>
                                 </div>` :
                                 `<div class="w-10 h-10 rounded-full ${day.completed ? 'bg-green-100' : 'bg-blue-100'} flex items-center justify-center">
                                     <i class="fas ${day.completed ? 'fa-check text-green-500' : 'fa-running text-blue-500'}"></i>
                                 </div>`}
                            </div>
                            <div class="flex-1">
                                <h4 class="font-bold text-gray-800">${day.day}</h4>
                                <p class="text-sm ${workoutType === 'Rest' ? 'text-gray-600' : 'text-gray-700'} mt-1">
                                    ${day.workout}
                                </p>
                                ${workoutType !== 'Rest' ? `
                                    <div class="mt-2 flex flex-wrap gap-1">
                                        ${renderWorkoutBadges(day.workout)}
                                    </div>
                                ` : ''}
                            </div>
                            <div class="ml-4">
                                ${day.completed ? 
                                 `<span class="bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full">Completo</span>` :
                                 `<button data-day-index="${index}" class="complete-day-btn bg-blue-600 hover:bg-blue-700 text-white text-xs px-3 py-1 rounded-full">
                                     Marcar
                                 </button>`}
                            </div>
                        </div>
                    `;
                    
                    weekScheduleEl.appendChild(dayEl);
                });
                
                // Update current week stats
                updateWeekStats(weekNum);
            }
            
            function renderWorkoutBadges(workout) {
                if (workout.includes('DAY OFF') || workout.includes('PROVA')) return '';
                
                let badges = '';
                
                // Detect all workout types in the string
                if (workout.includes('CA')) badges += `<span class="bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full"><i class="fas fa-walking mr-1"></i>Caminhada</span>`;
                if (workout.includes('LE')) badges += `<span class="bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full"><i class="fas fa-running mr-1"></i>Corrida Leve</span>`;
                if (workout.includes('MO')) badges += `<span class="bg-yellow-100 text-yellow-800 text-xs px-2 py-1 rounded-full"><i class="fas fa-fire mr-1"></i>Moderada</span>`;
                if (workout.includes('FO')) badges += `<span class="bg-orange-100 text-orange-800 text-xs px-2 py-1 rounded-full"><i class="fas fa-bolt mr-1"></i>Forte</span>`;
                if (workout.includes('MF')) badges += `<span class="bg-red-100 text-red-800 text-xs px-2 py-1 rounded-full"><i class="fas fa-heartbeat mr-1"></i>Muito Forte</span>`;
                
                return badges;
            }
            
            function updateWeekStats(weekNum) {
                const week = trainingProgram[weekNum];
                const completedCount = week.days.filter(day => day.completed).length;
                
                document.getElementById('current-week-completed').textContent = completedCount;
                document.getElementById('current-week-rest').textContent = week.days.filter(day => day.workout.includes('DAY OFF')).length;
                document.getElementById('current-week-duration').textContent = week.duration;
            }
            
            function updateOverallProgress() {
                // Calculate completed workouts
                let totalWorkouts = 0;
                let completedWorkouts = 0;
                let completedDays = 0;
                
                for (let weekNum in trainingProgram) {
                    trainingProgram[weekNum].days.forEach(day => {
                        if (!day.workout.includes('DAY OFF')) totalWorkouts++;
                        if (day.completed) completedDays++;
                        if (!day.workout.includes('DAY OFF') && day.completed) completedWorkouts++;
                    });
                }
                
                // Calculate percentages
                const workoutPercentage = Math.round((completedWorkouts / totalWorkouts) * 100);
                const dayPercentage = Math.round((completedDays / (7 * config.duration)) * 100);
                
                // Update UI
                document.getElementById('completed-workouts').textContent = completedWorkouts;
                document.getElementById('total-workouts').textContent = totalWorkouts;
                document.getElementById('days-completed').textContent = completedDays;
                
                const completedWeeks = Object.keys(trainingProgram).filter(weekNum => 
                    trainingProgram[weekNum].days.every(day => day.completed)
                ).length;
                
                document.getElementById('completed-weeks').textContent = completedWeeks;
                document.getElementById('total-completed-weeks').textContent = config.duration;
                
                document.getElementById('overall-progress').style.width = `${dayPercentage}%`;
                document.getElementById('progress-percentage').textContent = `${dayPercentage}%`;
                
                document.getElementById('user-progress-bar').style.width = `${workoutPercentage}%`;
                document.getElementById('user-progress-text').textContent = workoutPercentage;
            }
            
            function updateConfigUI() {
                // Update main header
                document.getElementById('goal-distance').textContent = `${config.distance}km`;
                document.getElementById('goal-weeks').textContent = config.duration;
                document.getElementById('total-weeks').textContent = config.duration;
                document.getElementById('final-goal').textContent = `${config.distance}K`;
                document.getElementById('final-weeks').textContent = config.duration;
                
                // Update athlete info panel
                document.getElementById('athlete-level').textContent = 
                    config.level === 'beginner' ? 'Iniciante' : 
                    config.level === 'intermediate' ? 'Intermedi√°rio' : 'Avan√ßado';
                
                document.getElementById('level-badge').textContent = 
                    config.level === 'beginner' ? 'Novato' : 
                    config.level === 'intermediate' ? 'Experiente' : 'Expert';
                
                document.getElementById('level-badge').className = 
                    config.level === 'beginner' ? 'ml-2 bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full' : 
                    config.level === 'intermediate' ? 'ml-2 bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full' : 
                    'ml-2 bg-red-100 text-red-800 text-xs px-2 py-1 rounded-full';
                
                document.getElementById('athlete-goal').textContent = `${config.distance} KM`;
                document.getElementById('athlete-duration').textContent = `${config.duration} semanas`;
            }
            
            // Training plan generators
            function generateBeginner5KPlan(weeks) {
                const plan = {};
                const baseDuration = 25;
                const durationIncrement = weeks > 8 ? 3 : 2;
                
                for (let i = 1; i <= weeks; i++) {
                    let title = `Semana ${i}`;
                    if (i === 1) title += " - Introdu√ß√£o";
                    if (i === weeks) title += " - PROVA 5KM";
                    
                    plan[i] = {
                        title: title,
                        description: i === weeks ? "Semana da prova!" : "Treinamento para 5K",
                        days: [
                            { day: "Segunda", workout: i === weeks ? "12'LE, 3x 5'CA" : "3'LE, 3x 12'CA", completed: false },
                            { day: "Ter√ßa", workout: "DAY OFF", completed: i === 1 },
                            { day: "Quarta", workout: "DAY OFF", completed: i === 1 },
                            { day: "Quinta", workout: "DAY OFF", completed: i === 1 },
                            { day: "Sexta", workout: "DAY OFF", completed: i === 1 },
                            { day: "S√°bado", workout: i === weeks ? "PROVA 5KM" : "3'LE, 2'CA", completed: false },
                            { day: "Domingo", workout: "DAY OFF", completed: i === 1 }
                        ],
                        duration: baseDuration + ((i - 1) * durationIncrement)
                    };
                }
                
                return plan;
            }
            
            function generateBeginner10KPlan(weeks) {
                const plan = {};
                const baseDuration = 30;
                const durationIncrement = weeks > 8 ? 4 : 3;
                
                for (let i = 1; i <= weeks; i++) {
                    let title = `Semana ${i}`;
                    if (i === 1) title += " - Introdu√ß√£o";
                    if (i === weeks) title += " - PROVA 10KM";
                    
                    plan[i] = {
                        title: title,
                        description: i === weeks ? "Semana da prova!" : "Treinamento para 10K",
                        days: [
                            { day: "Segunda", workout: i === weeks ? "15'LE, 3x 8'CA" : "5'LE, 3x 15'CA", completed: false },
                            { day: "Ter√ßa", workout: "DAY OFF", completed: i === 1 },
                            { day: "Quarta", workout: "DAY OFF", completed: i === 1 },
                            { day: "Quinta", workout: "DAY OFF", completed: i === 1 },
                            { day: "Sexta", workout: "DAY OFF", completed: i === 1 },
                            { day: "S√°bado", workout: i === weeks ? "PROVA 10KM" : "5'LE, 3'CA", completed: false },
                            { day: "Domingo", workout: "DAY OFF", completed: i === 1 }
                        ],
                        duration: baseDuration + ((i - 1) * durationIncrement)
                    };
                }
                
                return plan;
            }
            
            function generateBeginnerHalfMarathonPlan(weeks) {
                const plan = {};
                const baseDuration = 40;
                const durationIncrement = weeks > 8 ? 6 : 4;
                
                for (let i = 1; i <= weeks; i++) {
                    let title = `Semana ${i}`;
                    if (i === 1) title += " - Introdu√ß√£o";
                    if (i === weeks) title += " - PROVA 21KM";
                    
                    plan[i] = {
                        title: title,
                        description: i === weeks ? "Semana da prova!" : "Treinamento para meia maratona",
                        days: [
                            { day: "Segunda", workout: i === weeks ? "20'LE, 4x 10'CA" : "8'LE, 4x 18'CA", completed: false },
                            { day: "Ter√ßa", workout: "DAY OFF", completed: i === 1 },
                            { day: "Quarta", workout: "DAY OFF", completed: i === 1 },
                            { day: "Quinta", workout: "DAY OFF", completed: i === 1 },
                            { day: "Sexta", workout: "DAY OFF", completed: i === 1 },
                            { day: "S√°bado", workout: i === weeks ? "PROVA 21KM" : "8'LE, 5'CA", completed: false },
                            { day: "Domingo", workout: "DAY OFF", completed: i === 1 }
                        ],
                        duration: baseDuration + ((i - 1) * durationIncrement)
                    };
                }
                
                return plan;
            }
            
            function generateIntermediate5KPlan(weeks) {
                const plan = {};
                const baseDuration = 30;
                const durationIncrement = weeks > 8 ? 4 : 3;
                
                for (let i = 1; i <= weeks; i++) {
                    let title = `Semana ${i}`;
                    if (i === 1) title += " - Base";
                    if (i === weeks) title += " - PROVA 5KM";
                    
                    plan[i] = {
                        title: title,
                        description: i === weeks ? "Semana da prova!" : "Treinamento intensivo para 5K",
                        days: [
                            { day: "Segunda", workout: i === weeks ? "15'LE, 2x 8'MO" : "5'LE, 3x 10'MO", completed: false },
                            { day: "Ter√ßa", workout: "DAY OFF", completed: false },
                            { day: "Quarta", workout: "10'LE, 2x 5'FO", completed: false },
                            { day: "Quinta", workout: "DAY OFF", completed: false },
                            { day: "Sexta", workout: "8'LE, 4x 3'FO", completed: false },
                            { day: "S√°bado", workout: i === weeks ? "PROVA 5KM" : "5'LE, 3'CA", completed: false },
                            { day: "Domingo", workout: "DAY OFF", completed: false }
                        ],
                        duration: baseDuration + ((i - 1) * durationIncrement)
                    };
                }
                
                return plan;
            }
            
            function generateIntermediate10KPlan(weeks) {
                const plan = {};
                const baseDuration = 40;
                const durationIncrement = weeks > 8 ? 5 : 4;
                
                for (let i = 1; i <= weeks; i++) {
                    let title = `Semana ${i}`;
                    if (i === 1) title += " - Base";
                    if (i === weeks) title += " - PROVA 10KM";
                    
                    plan[i] = {
                        title: title,
                        description: i === weeks ? "Semana da prova!" : "Treinamento intensivo para 10K",
                        days: [
                            { day: "Segunda", workout: i === weeks ? "20'LE, 2x 10'MO" : "8'LE, 3x 12'MO", completed: false },
                            { day: "Ter√ßa", workout: "DAY OFF", completed: false },
                            { day: "Quarta", workout: "15'LE, 2x 8'FO", completed: false },
                            { day: "Quinta", workout: "DAY OFF", completed: false },
                            { day: "Sexta", workout: "10'LE, 4x 5'FO", completed: false },
                            { day: "S√°bado", workout: i === weeks ? "PROVA 10KM" : "8'LE, 5'CA", completed: false },
                            { day: "Domingo", workout: "DAY OFF", completed: false }
                        ],
                        duration: baseDuration + ((i - 1) * durationIncrement)
                    };
                }
                
                return plan;
            }
            
            function generateIntermediateHalfMarathonPlan(weeks) {
                const plan = {};
                const baseDuration = 50;
                const durationIncrement = weeks > 8 ? 7 : 5;
                
                for (let i = 1; i <= weeks; i++) {
                    let title = `Semana ${i}`;
                    if (i === 1) title += " - Base";
                    if (i === weeks) title += " - PROVA 21KM";
                    
                    plan[i] = {
                        title: title,
                        description: i === weeks ? "Semana da prova!" : "Treinamento intensivo para meia maratona",
                        days: [
                            { day: "Segunda", workout: i === weeks ? "25'LE, 2x 15'MO" : "10'LE, 3x 15'MO", completed: false },
                            { day: "Ter√ßa", workout: "DAY OFF", completed: false },
                            { day: "Quarta", workout: "20'LE, 2x 10'FO", completed: false },
                            { day: "Quinta", workout: "DAY OFF", completed: false },
                            { day: "Sexta", workout: "15'LE, 4x 8'FO", completed: false },
                            { day: "S√°bado", workout: i === weeks ? "PROVA 21KM" : "10'LE, 8'CA", completed: false },
                            { day: "Domingo", workout: "DAY OFF", completed: false }
                        ],
                        duration: baseDuration + ((i - 1) * durationIncrement)
                    };
                }
                
                return plan;
            }
            
            function generateAdvanced5KPlan(weeks) {
                const plan = {};
                const baseDuration = 35;
                const durationIncrement = weeks > 8 ? 5 : 4;
                
                for (let i = 1; i <= weeks; i++) {
                    let title = `Semana ${i}`;
                    if (i === 1) title += " - Base";
                    if (i === weeks) title += " - PROVA 5KM";
                    
                    plan[i] = {
                        title: title,
                        description: i === weeks ? "Semana da prova!" : "Treinamento avan√ßado para 5K",
                        days: [
                            { day: "Segunda", workout: i === weeks ? "15'LE, 2x 8'MF" : "5'LE, 3x 10'MF", completed: false },
                            { day: "Ter√ßa", workout: "10'LE, 5x 3'FO", completed: false },
                            { day: "Quarta", workout: "15'LE, 2x 5'MF", completed: false },
                            { day: "Quinta", workout: "DAY OFF", completed: false },
                            { day: "Sexta", workout: "8'LE, 6x 2'MF", completed: false },
                            { day: "S√°bado", workout: i === weeks ? "PROVA 5KM" : "5'LE, 3'CA", completed: false },
                            { day: "Domingo", workout: "DAY OFF", completed: false }
                        ],
                        duration: baseDuration + ((i - 1) * durationIncrement)
                    };
                }
                
                return plan;
            }
            
            function generateAdvanced10KPlan(weeks) {
                const plan = {};
                const baseDuration = 45;
                const durationIncrement = weeks > 8 ? 6 : 5;
                
                for (let i = 1; i <= weeks; i++) {
                    let title = `Semana ${i}`;
                    if (i === 1) title += " - Base";
                    if (i === weeks) title += " - PROVA 10KM";
                    
                    plan[i] = {
                        title: title,
                        description: i === weeks ? "Semana da prova!" : "Treinamento avan√ßado para 10K",
                        days: [
                            { day: "Segunda", workout: i === weeks ? "20'LE, 2x 10'MF" : "8'LE, 3x 12'MF", completed: false },
                            { day: "Ter√ßa", workout: "15'LE, 5x 5'FO", completed: false },
                            { day: "Quarta", workout: "20'LE, 2x 8'MF", completed: false },
                            { day: "Quinta", workout: "DAY OFF", completed: false },
                            { day: "Sexta", workout: "12'LE, 6x 3'MF", completed: false },
                            { day: "S√°bado", workout: i === weeks ? "PROVA 10KM" : "8'LE, 5'CA", completed: false },
                            { day: "Domingo", workout: "DAY OFF", completed: false }
                        ],
                        duration: baseDuration + ((i - 1) * durationIncrement)
                    };
                }
                
                return plan;
            }
            
            function generateAdvancedHalfMarathonPlan(weeks) {
                const plan = {};
                const baseDuration = 60;
                const durationIncrement = weeks > 8 ? 8 : 6;
                
                for (let i = 1; i <= weeks; i++) {
                    let title = `Semana ${i}`;
                    if (i === 1) title += " - Base";
                    if (i === weeks) title += " - PROVA 21KM";
                    
                    plan[i] = {
                        title: title,
                        description: i === weeks ? "Semana da prova!" : "Treinamento avan√ßado para meia maratona",
                        days: [
                            { day: "Segunda", workout: i === weeks ? "25'LE, 2x 15'MF" : "10'LE, 3x 15'MF", completed: false },
                            { day: "Ter√ßa", workout: "20'LE, 5x 8'FO", completed: false },
                            { day: "Quarta", workout: "25'LE, 2x 10'MF", completed: false },
                            { day: "Quinta", workout: "DAY OFF", completed: false },
                            { day: "Sexta", workout: "15'LE, 6x 5'MF", completed: false },
                            { day: "S√°bado", workout: i === weeks ? "PROVA 21KM" : "10'LE, 8'CA", completed: false },
                            { day: "Domingo", workout: "DAY OFF", completed: false }
                        ],
                        duration: baseDuration + ((i - 1) * durationIncrement)
                    };
                }
                
                return plan;
            }
        });
    </script>
</body>
</html>